<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<link href='http://www.dpaxinos.com/feed.xml' rel='alternate' type='application/atom+xml'>

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <!-- <link href='http://fonts.googleapis.com/css?family=Fjalla+One|Cuprum:400,400italic|Maven+Pro' rel='stylesheet' type='text/css'> -->
<link href='http://fonts.googleapis.com/css?family=Lekton|Cabin|Yanone+Kaffeesatz:300|Oxygen|Fjalla+One|Cuprum:400,400italic|Maven+Pro|Arapey|Homenaje|Orbitron:900' rel='stylesheet' type='text/css'>
  <!--   <link href='http://fonts.googleapis.com/css?family=Abel|PT+Sans+Narrow:400,700|Quicksand|Lobster|Tangerine|Fjalla+One|Inconsolata:400,700|Yanone+Kaffeesatz|Pacifico|Oswald:300|Orbitron:900' rel='stylesheet' type='text/css'> -->
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Home &middot; Dimitris Paxinos
    
  </title> 
  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/site.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png"> 
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54447083-1', 'auto');
  ga('send', 'pageview');

</script>
  <!-- <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'dimitrispaxinosblog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script> -->
<body>
    <div class="container content">
        <div class="masthead">
            <h3 class="masthead-title">
                <a href="/" title="Home">Dimitris Paxinos</a>
                 <!-- <small>.NET and other programming stories</small>  -->
                <ul class="menu">
                    
                    &nbsp;&nbsp;&nbsp;
                    <li><a href="/aboutme.html">About</a></li>
                    
                    &nbsp;&nbsp;&nbsp;
                    <li><a href="/archive.html">Archive</a></li>
                    
                    &nbsp;&nbsp;&nbsp;
                    <li><a href="/tags.html">Tags</a></li>
                    
                    &nbsp;&nbsp;&nbsp;
                    <li><a href="/feed.xml">Rss</a></li>
                    
                    <ul>
            </h3>
			<h3 class="masthead-title">			
			<small>.NET and other programming stories</small> 
			</h3>
        </div>

        <div class="posts">
    
	
    <div class="post">
        <h1 class="post-title">
            <a href="/blog/2015/03/A-Pageable-and-Sortable-WPF-DataGrid">
                A Pageable and Sortable WPF DataGrid
            </a>
        </h1>
        <span class="post-date">March 08, 2015</span>
        <h2>Introduction</h2>

<p>There was recently a need for a WPF DataGrid paging and sorting functionality in a project I am currently working on. The goal was to find a reusable solution that can easily be used across the project. A complete working sample can be found on <a href="https://github.com/dimitrispaxinos/WPFDemos/tree/master/PageableDataGridDemo"><strong>Github</strong></a>.  In this blog post, we will go through the main points of the implementation. </p>

<p>This DataGrid has the following features:</p>

<ul>
<li>Page navigation</li>
<li>Dynamically adjustable page size</li>
<li>Sorting functionality for the whole item collection</li>
<li>Item addition at the top of the first page</li>
<li>Item removal while remaining on the selected page</li>
</ul>

<p><img src="https://raw.githubusercontent.com/dimitrispaxinos/dimitrispaxinos.github.io/master/_assets/images/wpfDataGridPost_AppScreenShot.png" alt="Class Diagram"></p>

<h2>Implementation</h2>

<p>The solution can be divided into two parts. We will start with Paging and continue with Sorting. Paging was solely implemented in the ViewModel. Sorting required the ViewModel to be extended and the DataGrid (class) to be subclassed.  </p>

<p>Although we could have encapsulated the ViewModel paging and sorting functionality in one class, we are going to use two classes, one for paging and another one (which inherits from the paging class) for the sorting so that the implementation is a bit more clear.</p>

<h3>Paging</h3>

<p>As said earlier, we are going to implement the functionality using only the ViewModel. We will create a new <code>PageableCollection&lt;T&gt;</code> class which implements <code>INotifyPropertyChanged</code>, encapsulates  all the paging logic and exposes an <code>ObservableCollection&lt;T&gt;</code>  property, <code>CurrentPageItems</code> for the DataGrid&#39;s ItemsSource to bind to.</p>

<p><img src="https://raw.githubusercontent.com/dimitrispaxinos/dimitrispaxinos.github.io/master/_assets/images/wpfDataGridPost_ClassDiagram.png" alt="Class Diagram"></p>

<p>You can see the most important properties and methods in the above table. Although the names are self explanatory, here is a brief description for each one: </p>

<p><strong>CurrentPageNumber:</strong> The number of the page we are currently on.</p>

<p><strong>CurrentPageItems:</strong>  An <code>ObservableCollection&lt;T&gt;</code> which contains the objects of type T that are listed on the current page. The ItemsSource of the DataGrid will be bound to this property</p>

<p><strong>PageSize:</strong> The number of entries shown per page. Every time this property gets updated, the whole collection gets reset and returns to the first page.</p>

<p><strong>TotalPagesNumber:</strong> The total number of pages, depending on the page size.</p>

<p><strong>GoToNextPage, GoToPreviousPage:</strong> The two navigation void methods we will use to move to the next and previous page respectively.</p>

<p><strong>Add:</strong> This method is used for adding a new item to our collection . The collection is reset with new item being inserted at the top of the first page.</p>

<p><strong>Remove:</strong> This method is used for removing an item. The item gets removed while remaining on the same page.</p>

<p><strong>If you only need the sorting functionality, you can directly use the</strong> <code>PageableCollection&lt;T&gt;</code> <strong>class below.</strong></p>

<script src="https://gist.github.com/dimitrispaxinos/5decda1d12a2de89b3cf.js"></script>

<h3>Sorting</h3>

<p>The problem that has to be tackled is the fact that the DataGrid can only sort its ItemsSource. In our case, this only includes the items of the current page. Therefore, <strong>sorting has to be delegated from the DataGrid to the complete items list.</strong> </p>

<p>In order to achieve that, we have to use some code-behind and since we would like to develop a reusable component, we are going to encapsulate this functionality in a new class deriving from the DataGrid class.</p>

<p>The new <code>SortableDataGrid</code> class will be having an <code>ISortable</code> dependency property
<script src="https://gist.github.com/dimitrispaxinos/abd7b3e33e7596db0725.js"></script></p>

<p>and the Sort method is going to be called every time the sorting event fires in the Grid. Let us have a look at the class: </p>

<script src="https://gist.github.com/dimitrispaxinos/242437281ffe316cb291.js"></script>

<p>The new <code>SortableDataGrid</code> class:</p>

<ol>
<li>Has an <code>ISortable</code> dependency property <code>FullItemsSource</code> </li>
<li>Overrides the <code>OnInitialized</code> event handler and stores the initial column which is used for sorting.</li>
<li>Overrides the <code>OnSorting</code> event handler, cancels the default sorting functionality and calls the Sort method of the <code>ISortable</code> dependency property with the property name and the sorting direction as input parameters.</li>
<li>Overrides the <code>OnItemsSourceChanged</code> event handler in order to retain the sorting direction during page navigation.</li>
</ol>

<p>The <code>ISortable</code> interface gets implemented by the <code>SortablePageableCollection</code> where the property to be used for sorting is found using reflection:</p>

<script src="https://gist.github.com/dimitrispaxinos/90261818ea42833f3605.js"></script>

<p>Finally, in our XAML code, all we have to do is set the bindings for both the FullItemsSource and  ItemsSource.</p>

<script src="https://gist.github.com/dimitrispaxinos/0a4e67992a1ea9ffe9dc.js"></script>

        </br>

        <ul class="tags">
            
            <li><a href="/tags/WPF" class="tag" title="View posts tagged with &quot;WPF&quot;">WPF</a></li>
              
            <li><a href="/tags/DataGrid" class="tag" title="View posts tagged with &quot;DataGrid&quot;">DataGrid</a></li>
              
            <li><a href="/tags/Tutorial" class="tag" title="View posts tagged with &quot;Tutorial&quot;">Tutorial</a></li>
              
            <li><a href="/tags/Paging" class="tag" title="View posts tagged with &quot;Paging&quot;">Paging</a></li>
              
            <li><a href="/tags/Sorting" class="tag" title="View posts tagged with &quot;Sorting&quot;">Sorting</a></li>
             
        </ul>
        </br>		
	<a href="/blog/2015/03/A-Pageable-and-Sortable-WPF-DataGrid/#disqus_thread">Comments</a>	
	</br>
    </div>
	
    
	
    <div class="post">
        <h1 class="post-title">
            <a href="/blog/2015/02/Trying-out-a-different-approach">
                Trying out a different approach
            </a>
        </h1>
        <span class="post-date">February 22, 2015</span>
        <h3>The Occasion</h3>

<p>About a month ago, I stumbled across an ad about an event that would take place in Hamburg at the end of January. What kind of event? Its name was <a href="http://www.businesshackweekend.com/">“Business Hack Weekend”</a>. I visited the event&#39;s website and the whole concept seemed intriguing. To be honest, the name <em>“hack”</em> itself was compelling enough since I had never been to a hackathon or anything of that sort before. Long story short, I decided to go! </p>

<p>The main idea was that there were a few companies participating which would present one of their business problems. All these problems had to be solved in 54 hours by a team having two to three representatives from the company plus some other participants from various backgrounds, like me. At the end of the two days, each team had to pitch the idea with the best solution winning a prize.</p>

<p>I arrived at the event&#39;s venue on a Friday afternoon. The atmosphere of the really nice, industrial style place had a strong sense of the startup culture. These last two words bring me to the most important observation of this weekend which was that...</p>

<p>Every Startuper that  has a minimum self-esteem owns a MacBook. The place was full of them! Everyone was sitting in front of a Mac and I am pretty sure that there was an unofficial ongoing competition regarding the number of stickers that could possibly fit on a Mac. I really felt guilty when I had to get my humble Lenovo out of my bag! :)</p>

<p><img src="https://raw.githubusercontent.com/dimitrispaxinos/dimitrispaxinos.github.io/master/_assets/images/MacBookStickers.jpg" alt="Rebase"></p>

<h3>The Initial Disappointment</h3>

<p>The team I was in had to <em>“help”</em> <a href="http://www.stage-entertainment.de/">Stage Entertainment</a>, a global leader in live entertainment producing award-winning musicals attract more viewers to their shows. </p>

<p>I will start by telling you that the weekend did not include any programming at all, not even a single line of code. Boring you may say... That&#39;s what I thought as well! What was I doing there with all these non-coders? I was ready to get down to code for two days straight drinking Red Bull like in the movies. You can perhaps imagine my disappointment.  </p>

<h3>The Surprise</h3>

<p>But, to my surprise, it turned out to be actually refreshing. I had the opportunity to meet some really cool people from various backgrounds and see various approaches to the same problem, see things from a different perspective. </p>

<p>As I wrote earlier, the goal was to attract more people to their shows every year. Can you possibly guess what was the first idea of a software developer like me? I started asking about the online ticketing system, how intuitive it was and how much time was needed in order to purchase a ticket. There were two guys in the team working in the advertising industry. They immediately proposed a new advertising campaign.</p>

<h3>The Conclusion</h3>

<p>Everyone focuses on his area of expertise and tries to find a solution in this particular area. And this is perfectly normal. Nevertheless, I believe that it is worth trying to see things from a different point of view by meeting people who tackle the same problem in a completely different way. And I am certain that you will be surprised by the ideas that never crossed your mind.</p>

<blockquote>
<p>Nowadays, we get often trapped in our area of expertise since this area itself is very dynamic and already hard to keep up with so there is no time or opportunity to try solve problems differently. </p>
</blockquote>

<p>In programming for example, you might realize that you mostly code or solve problems the way you have learned or are used to using a standard technology. Why? Because you have invested time in learning it, you maybe think it is the best approach or because it is simply faster and, as we all know, time is money. </p>

<p>If you can&#39;t try out a new approach on a professional level, you might just try it in your spare time by meeting people that already do it. And you can attempt all that without leaving your professional comfort zone. As mentioned earlier, you might be really surprised...</p>

        </br>

        <ul class="tags">
            
            <li><a href="/tags/hackathon" class="tag" title="View posts tagged with &quot;hackathon&quot;">hackathon</a></li>
              
            <li><a href="/tags/hamburg" class="tag" title="View posts tagged with &quot;hamburg&quot;">hamburg</a></li>
              
            <li><a href="/tags/businesshackweekend" class="tag" title="View posts tagged with &quot;businesshackweekend&quot;">businesshackweekend</a></li>
             
        </ul>
        </br>		
	<a href="/blog/2015/02/Trying-out-a-different-approach/#disqus_thread">Comments</a>	
	</br>
    </div>
	
    
</div>

<div>
    <ul class="pager">
		
        
        <li>
            <a href="/page6">&larr; Older</a>
        </li>
        
        
        
        <li>
            <a href="/page4">Newer &rarr;</a>
        </li>
        
        
		 
    </ul>
</div>


        <div class="footer">
            <p>
                &copy; Dimitris Paxinos 2015. All rights reserved.
            </p>
        </div>
    </div>
	<script id="dsq-count-scr" src="//dimitrispaxinosblog.disqus.com/count.js" async></script>
</body>
</html>
